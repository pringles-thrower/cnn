# PWaveNET: глубокая нейросеть для детектирования P-волн

*PWaveNET* – это глубокая сверточная нейронная сеть, разработанная для автоматического обнаружения момента прихода P-волны (первой продольной волны) в сигналах акустической эмиссии (AE) лабораторных экспериментов. Данный метод позволяет заменить трудоемкую ручную разметку сигналов на автоматизированное детектирование, обеспечивая высокую точность выявления первых вступлений P-волн даже при низком уровне сигнала.

## Описание задачи

Акустическая эмиссия – это метод мониторинга микросейсмической активности материалов (например, горных пород, бетона и др.) в лаборатории. При механических нагрузках материалы излучают упругие волны, которые регистрируются чувствительными датчиками. Первой приходит продольная волна (P-волна), и точное определение момента ее прихода чрезвычайно важно для последующего анализа: локализации источников эмиссии, вычисления скоростей волн в образце, определения механизмов источников и т.д.

**Цель данного проекта** – разработать метод на основе глубокого обучения для автоматического детектирования P-волн, способный заменить ручную разметку и превзойти классические алгоритмы по точности.

## Использование

1. **Установка окружения**  
   Установите зависимости командой:
   ```bash
   pip install -r requirements.txt
   ```

2. **Запуск Jupyter Notebook**  
   Откройте `notebooks/full_file.ipynb` и запустите все ячейки. Это выполнит:
   - Загрузку и предобработку данных из папки `data/`
   - Определение и обучение архитектуры PWaveNET
   - Инференс на тестовых и демонстрационных сигналах  
   По завершении в папке `weights/` будет сохранен файл веса модели (например, `pwavenet_weights.pt`), а в папке `examples/` появятся визуализации результатов детектирования.

3. **Применение модели на новых данных**  
   Добавьте свои файлы сигналов в папку `data/` и адаптируйте их имена в ноутбуке. Запустите инференс для получения предсказаний.

## Пример данных

- `data/ExampleWaveform1.csv` и `data/ExampleWaveform2.csv` — файлы с сигналами AE (амплитуда vs. время).
- `data/Manual_pickings.csv` — файл с ручной разметкой времени прихода P-волн в этих сигналах. Формат: `filename,arrival_time_sec`.

## Требования

[![Python](https://img.shields.io/badge/Python-3.9%2B-blue?logo=python)](https://www.python.org/)  
[![PyTorch](https://img.shields.io/badge/PyTorch-2.x-red?logo=pytorch)]

## Демонстрация результатов

| Метрика | AIC-пикер | **PWaveNET (1000 сигн.)** |
|---------|-----------|---------------------------|
| F1-score| 0.59      | **0.90** |
| MAE, отсчёты | 10.0 | **6.0** |
